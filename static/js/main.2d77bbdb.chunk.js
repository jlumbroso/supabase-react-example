(this["webpackJsonpreact-user-management"]=this["webpackJsonpreact-user-management"]||[]).push([[0],{13:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(5),r=a.n(n),c=a(14),s=a.n(c),i=(a(13),a(6)),u=a(16),l=Object(u.a)("https://yvbgceiaumxhecoikudx.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl2YmdjZWlhdW14aGVjb2lrdWR4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2Njg2NjUzMDksImV4cCI6MTk4NDI0MTMwOX0.cuUL6RuS2iTVNq1ckjoEedKtAG70sm6abVybL-zSDyI"),o=a(0),b=a(7),j=a(3);function d(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(""),s=Object(i.a)(c,2),u=s[0],d=s[1],p=function(){var e=Object(b.a)(Object(o.a)().mark((function e(t){var a,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),e.next=4,l.auth.signInWithOtp({email:t,emailRedirectTo:"https://jlumbroso.github.io/supabase-react-example"});case 4:if(a=e.sent,!(n=a.error)){e.next=8;break}throw n;case 8:alert("Check your email for the login link!"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),alert(e.t0.error_description||e.t0.message);case 14:return e.prev=14,r(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,11,14,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsx)("div",{className:"row flex flex-center",children:Object(j.jsxs)("div",{className:"col-6 form-widget",children:[Object(j.jsx)("h1",{className:"header",children:"Supabase + React"}),Object(j.jsx)("p",{className:"description",children:"Sign in via magic link with your email below"}),Object(j.jsx)("div",{children:Object(j.jsx)("input",{className:"inputField",type:"email",placeholder:"Your email",value:u,onChange:function(e){return d(e.target.value)}})}),Object(j.jsx)("div",{children:Object(j.jsx)("button",{onClick:function(e){e.preventDefault(),p(u)},className:"button block",disabled:a,children:a?Object(j.jsx)("span",{children:"Loading"}):Object(j.jsx)("span",{children:"Send magic link"})})})]})})}function p(e){var t=e.url,a=e.size,r=e.onUpload,c=Object(n.useState)(null),s=Object(i.a)(c,2),u=s[0],d=s[1],p=Object(n.useState)(!1),h=Object(i.a)(p,2),O=h[0],m=h[1];function f(){return(f=Object(b.a)(Object(o.a)().mark((function e(t){var a,n,r,c;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.storage.from("avatars").download(t);case 3:if(a=e.sent,n=a.data,!(r=a.error)){e.next=8;break}throw r;case 8:c=URL.createObjectURL(n),d(c),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("Error downloading image: ",e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function v(){return(v=Object(b.a)(Object(o.a)().mark((function e(t){var a,n,c,s,i,u;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,m(!0),t.target.files&&0!==t.target.files.length){e.next=4;break}throw new Error("You must select an image to upload.");case 4:return a=t.target.files[0],n=a.name.split(".").pop(),c="".concat(Math.random(),".").concat(n),s="".concat(c),e.next=10,l.storage.from("avatars").upload(s,a);case 10:if(i=e.sent,!(u=i.error)){e.next=14;break}throw u;case 14:r(s),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),alert(e.t0.message);case 20:return e.prev=20,m(!1),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[0,17,20,23]])})))).apply(this,arguments)}return Object(n.useEffect)((function(){t&&function(e){f.apply(this,arguments)}(t)}),[t]),Object(j.jsxs)("div",{children:[u?Object(j.jsx)("img",{src:u,alt:"Avatar",className:"avatar image",style:{height:a,width:a}}):Object(j.jsx)("div",{className:"avatar no-image",style:{height:a,width:a}}),Object(j.jsxs)("div",{style:{width:a},children:[Object(j.jsx)("label",{className:"button primary block",htmlFor:"single",children:O?"Uploading ...":"Upload"}),Object(j.jsx)("input",{style:{visibility:"hidden",position:"absolute"},type:"file",id:"single",accept:"image/*",onChange:function(e){return v.apply(this,arguments)},disabled:O})]})]})}function h(e){var t=e.session,a=Object(n.useState)(!0),r=Object(i.a)(a,2),c=r[0],s=r[1],u=Object(n.useState)(null),d=Object(i.a)(u,2),h=d[0],O=d[1],m=Object(n.useState)(null),f=Object(i.a)(m,2),v=f[0],x=f[1],g=Object(n.useState)(null),w=Object(i.a)(g,2),k=w[0],y=w[1];function S(e){return I.apply(this,arguments)}function I(){return I=Object(b.a)(Object(o.a)().mark((function e(a){var n,r,c,i,u,b,j;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.username,r=a.website,c=a.avatar_url,e.prev=1,s(!0),i=t.user,u={id:i.id,username:n,website:r,avatar_url:c,updated_at:new Date},e.next=7,l.from("profiles").upsert(u);case 7:if(b=e.sent,!(j=b.error)){e.next=11;break}throw j;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),alert(e.t0.message);case 16:return e.prev=16,s(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,13,16,19]])}))),I.apply(this,arguments)}return Object(n.useEffect)((function(){function e(){return(e=Object(b.a)(Object(o.a)().mark((function e(){var a,n,r,c;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s(!0),a=t.user,e.next=5,l.from("profiles").select("username, website, avatar_url").eq("id",a.id).single();case 5:if(n=e.sent,r=n.data,!(c=n.error)){e.next=10;break}throw c;case 10:O(r.username),x(r.website),y(r.avatar_url),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.warn(e.t0.message);case 18:return e.prev=18,s(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[0,15,18,21]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]),Object(j.jsxs)("div",{className:"form-widget",children:[Object(j.jsx)(p,{url:k,size:150,onUpload:function(e){y(e),S({username:h,website:v,avatar_url:e})}}),Object(j.jsxs)("div",{children:[Object(j.jsx)("label",{htmlFor:"email",children:"Email"}),Object(j.jsx)("input",{id:"email",type:"text",value:t.user.email,disabled:!0})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("label",{htmlFor:"username",children:"Name"}),Object(j.jsx)("input",{id:"username",type:"text",value:h||"",onChange:function(e){return O(e.target.value)}})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("label",{htmlFor:"website",children:"Website"}),Object(j.jsx)("input",{id:"website",type:"website",value:v||"",onChange:function(e){return x(e.target.value)}})]}),Object(j.jsx)("div",{children:Object(j.jsx)("button",{className:"button block primary",onClick:function(){return S({username:h,website:v,avatar_url:k})},disabled:c,children:c?"Loading ...":"Update"})}),Object(j.jsx)("div",{children:Object(j.jsx)("button",{className:"button block",onClick:function(){return l.auth.signOut()},children:"Sign Out"})})]})}function O(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){l.auth.getSession().then((function(e){var t=e.data.session;r(t)})),l.auth.onAuthStateChange((function(e,t){r(t)}))}),[]),Object(j.jsx)("div",{className:"container",style:{padding:"50px 0 100px 0"},children:a?Object(j.jsx)(h,{session:a},a.user.id):Object(j.jsx)(d,{})})}var m=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,33)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};s.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(O,{})}),document.getElementById("root")),m()}},[[31,1,2]]]);
//# sourceMappingURL=main.2d77bbdb.chunk.js.map